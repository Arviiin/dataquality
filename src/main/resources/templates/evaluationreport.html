<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
</head>
<body>
<p>尊敬的
  <span th:text="${name}"></span>
  ：这里有一份您的数据质量评价报告，请注意查收
</p>

<h1 style="font-size: 16px; text-align: center" >数据质量评价报告</h1>
<br>
<table border="1" style="margin: 0 auto;">
  <tr >
    <th>名称</th>
    <td colspan="3" th:text="${evaluationName}"></td>
    <!--<td></td>-->
    <!--<td></td>-->
    <th>评价人员</th>
    <td colspan="2" th:text="${evaluationRemarkUsername}"></td>
    <!--<td></td>-->
  </tr>
  <tr>
    <th>编号</th>
    <td colspan="3" th:text="${evaluationNumber}"></td>
    <!--<td></td>-->
    <!--<td></td>-->
    <th>评价时间</th>
    <td colspan="2" th:text="${#dates.format(dimensionDetailResultBean.updatetime, 'yyyy-MM-dd')}"></td>
    <!--<td></td>-->
  </tr>
  <tr>
    <th colspan="7" style="height: 60px; font-size: 16px;">评价内容</th>
  </tr>
  <tr>
    <th >序号</th>
    <th>质量维度指标</th>
    <th>指标权重</th>
    <th>合格数量</th>
    <th>总数</th>
    <th>得分</th>
    <th>加权得分</th>
  </tr>
  <tr>
    <td>1</td>
    <td>完备性</td>
    <td th:text="${weightResult.completeness}"></td>
    <td th:text="${(dimensionDetailResultBean.dataFileCompletenessResult+dimensionDetailResultBean.dataValueCompletenessResult)/2}"></td>
    <td th:text="${(dimensionDetailResultBean.expectedTotalRecordAmount+dimensionDetailResultBean.totalRecordAmountOfDataValueCompleteness)/2}"></td>
    <td th:text="${dimensionResultRatioBean.Completeness}"></td>
    <td th:text="${dimensionScore.dataCompletenessScore}"></td>
  </tr>
  <tr>
    <td>2</td>
    <td>一致性</td>
    <td th:text="${weightResult.consistency}"></td>
    <td th:text="${(dimensionDetailResultBean.referentialConsistencyResult+dimensionDetailResultBean.formatConsistencyResult)/2}"></td>
    <td th:text="${(dimensionDetailResultBean.totalRecordAmountOfFormatConsistency+dimensionDetailResultBean.totalRecordAmountOfReferentialConsistency)/2}"></td>
    <td th:text="${dimensionResultRatioBean.Consistency}"></td>
    <td th:text="${dimensionScore.dataConsistencyScore}"></td>
  </tr>
  <tr>
    <td>3</td>
    <td>依从性</td>
    <td th:text="${weightResult.compliance}"></td>
    <td th:text="${dimensionDetailResultBean.dataRecordComplianceResult}"></td>
    <td th:text="${dimensionDetailResultBean.totalRecordAmountOfDataRecordCompliance}"></td>
    <td th:text="${dimensionResultRatioBean.Compliance}"></td>
    <td th:text="${dimensionScore.dataRecordComplianceScore}"></td>
  </tr>
  <tr>
    <td>4</td>
    <td>准确性</td>
    <td th:text="${weightResult.accuracy}"></td>
    <td th:text="${dimensionDetailResultBean.rangeAccuracyResult}"></td>
    <td th:text="${dimensionDetailResultBean.totalRecordAmountOfRangeAccuracy}"></td>
    <td th:text="${dimensionResultRatioBean.Accuracy}"></td>
    <td th:text="${dimensionScore.rangeAccuracyScore}"></td>
  </tr>
  <tr>
    <td>5</td>
    <td>唯一性</td>
    <td th:text="${weightResult.uniqueness}"></td>
    <td th:text="${dimensionDetailResultBean.recordUniquenessResult}"></td>
    <td th:text="${dimensionDetailResultBean.totalRecordAmountOfRecordUniqueness}"></td>
    <td th:text="${dimensionResultRatioBean.Uniqueness}"></td>
    <td th:text="${dimensionScore.recordUniquenessScore}"></td>
  </tr>
  <tr>
    <td>6</td>
    <td>现实性</td>
    <td th:text="${weightResult.timeliness}"></td>
    <td th:text="${dimensionDetailResultBean.timeBasedTimelinessResult}"></td>
    <td th:text="${dimensionDetailResultBean.totalRecordAmountOfTimeBasedTimeliness}"></td>
    <td th:text="${dimensionResultRatioBean.Timeliness}"></td>
    <td th:text="${dimensionScore.timeBasedTimelinessScore}"></td>
  </tr>
  <tr>
    <td>7</td>
    <td>保密性</td>
    <td th:text="${weightResult.vulnerability}"></td>
    <td th:text="${dimensionDetailResultBean.dataNonVulnerabilityResult*dimensionDetailResultBean.totalRecordAmountOfTimeBasedTimeliness/100}">Math.round(this.)</td>
    <td th:text="${dimensionDetailResultBean.totalRecordAmountOfTimeBasedTimeliness}"></td>
    <td th:text="${dimensionResultRatioBean.Confidentiality}"></td>
    <td th:text="${dimensionScore.dataNonVulnerabilityScore}"></td>
  </tr>
  <tr>
    <td></td>
    <th>综合加权总分</th>
    <td colspan="5" th:text="${dimensionScore.totalDataQualityScore}"></td>
  </tr>
  <tr>
    <td></td>
    <th>备注</th>
    <td colspan="5" th:text="${evaluationRemark}"></td>
  </tr>
  <tr>
    <td></td>
    <th>建议</th>
    <td colspan="5" style="text-align: left" th:text="${suggestion}"></td>
  </tr>
</table>
<p>
  <strong style="color: #F00; font-size: 24px;">
    希望在未来的日子里，携手共进!
  </strong>
</p>
</body>
</html>
